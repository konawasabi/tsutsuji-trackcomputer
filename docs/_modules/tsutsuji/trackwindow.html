

<!doctype html>

<html lang="jp">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>tsutsuji.trackwindow &#8212; tsutsuji-trackcomputer  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/bizstyle.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">tsutsuji-trackcomputer  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">tsutsuji.trackwindow</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for tsutsuji.trackwindow</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#    Copyright 2022 konawasabi</span>
<span class="c1">#</span>
<span class="c1">#    Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1">#    you may not use this file except in compliance with the License.</span>
<span class="c1">#    You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#        http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1">#    Unless required by applicable law or agreed to in writing, software</span>
<span class="c1">#    distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1">#    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1">#    See the License for the specific language governing permissions and</span>
<span class="c1">#    limitations under the License.</span>
<span class="c1">#</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span>
<span class="kn">import</span> <span class="nn">tkinter.simpledialog</span> <span class="k">as</span> <span class="nn">simpledialog</span>
<span class="kn">import</span> <span class="nn">tkinter.colorchooser</span> <span class="k">as</span> <span class="nn">colorchooser</span>
<span class="kn">from</span> <span class="nn">ttkwidgets</span> <span class="kn">import</span> <span class="n">CheckboxTreeview</span>

<div class="viewcode-block" id="TrackWindow"><a class="viewcode-back" href="../../tsutsuji.trackwindow.html#tsutsuji.trackwindow.TrackWindow">[docs]</a><span class="k">class</span> <span class="nc">TrackWindow</span><span class="p">(</span><span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mainwindow</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span> <span class="o">=</span> <span class="n">mainwindow</span>
        <span class="c1">#self.parent = master</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="kc">None</span>
<div class="viewcode-block" id="TrackWindow.create_window"><a class="viewcode-back" href="../../tsutsuji.trackwindow.html#tsutsuji.trackwindow.TrackWindow.create_window">[docs]</a>    <span class="k">def</span> <span class="nf">create_window</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#super().__init__(self.parent, padding=&#39;3 3 3 3&#39;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                ttk::style map Treeview </span><span class="se">\</span>
<span class="s2">                -foreground {disabled SystemGrayText </span><span class="se">\</span>
<span class="s2">                             selected SystemHighlightText} </span><span class="se">\</span>
<span class="s2">                -background {disabled SystemButtonFace </span><span class="se">\</span>
<span class="s2">                             selected SystemHighlight}</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tracks&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s1">&#39;WM_DELETE_WINDOW&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">closewindow</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">mainframe</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;3 3 3 3&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainframe</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainframe</span><span class="o">.</span><span class="n">rowconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainframe</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;+1100+0&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span> <span class="o">=</span> <span class="n">CheckboxTreeview</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainframe</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s1">&#39;tree headings&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;linecolor&#39;</span><span class="p">],</span><span class="n">selectmode</span><span class="o">=</span><span class="s1">&#39;browse&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;ButtonRelease&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">click_tracklist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;#0&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;linecolor&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s1">&#39;#0&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;track key&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s1">&#39;linecolor&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Color&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">tree_scrollbar</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Scrollbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainframe</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">yview</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tree_scrollbar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">N</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">E</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">yscrollcommand</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tree_scrollbar</span><span class="o">.</span><span class="n">set</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_treevalue</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sendtopmost</span><span class="p">()</span></div>
<div class="viewcode-block" id="TrackWindow.click_tracklist"><a class="viewcode-back" href="../../tsutsuji.trackwindow.html#tsutsuji.trackwindow.TrackWindow.click_tracklist">[docs]</a>    <span class="k">def</span> <span class="nf">click_tracklist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;軌道リストをクリックしたときのイベント処理</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">event</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">clicked_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">identify_column</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="n">clicked_track</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">identify_row</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="n">clicked_track_rematt</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;@OT_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">clicked_track</span><span class="p">)</span>
            <span class="n">clicked_zone</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="s1">&#39;widget&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">identify</span><span class="p">(</span><span class="s2">&quot;element&quot;</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">clicked_zone</span> <span class="o">==</span> <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="c1">#チェックボックスをクリックしたか</span>
                <span class="k">if</span> <span class="n">clicked_track</span> <span class="o">==</span> <span class="s1">&#39;root&#39;</span><span class="p">:</span> <span class="c1"># rootをクリックした場合、cfgファイルから読み込んだ軌道を一括設定</span>
                    <span class="k">for</span> <span class="n">tkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">track</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">tkey</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">tkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">get_checked</span><span class="p">():</span>
                        <span class="k">if</span> <span class="s1">&#39;@&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tkey</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">tkey</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">clicked_track</span> <span class="o">==</span> <span class="s1">&#39;seq_points&#39;</span><span class="p">:</span> <span class="c1"># seq_points をクリックした場合、kml/csvファイルから読み込んだ点列を一括設定</span>
                    <span class="k">for</span> <span class="n">tkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">tkey</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">tkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">get_checked</span><span class="p">():</span>
                        <span class="k">if</span> <span class="s1">&#39;@KML_&#39;</span> <span class="ow">in</span> <span class="n">tkey</span> <span class="ow">or</span> <span class="s1">&#39;@CSV_&#39;</span> <span class="ow">in</span> <span class="n">tkey</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">tkey</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">clicked_track</span> <span class="o">==</span> <span class="s1">&#39;generated&#39;</span><span class="p">:</span> <span class="c1"># generatedをクリックした場合、計算した他軌道を一括設定</span>
                    <span class="k">for</span> <span class="n">tkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">tkey</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">tkey</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">get_checked</span><span class="p">():</span>
                        <span class="k">if</span> <span class="s1">&#39;@OT_&#39;</span> <span class="ow">in</span> <span class="n">tkey</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;@OT_&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">tkey</span><span class="p">)][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="s1">&#39;@&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clicked_track</span><span class="p">:</span> <span class="c1"># 個別のtrack(自軌道形式)をクリックした場合</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s1">&#39;@KML_&#39;</span> <span class="ow">in</span> <span class="n">clicked_track</span> <span class="ow">or</span> <span class="s1">&#39;@CSV_&#39;</span> <span class="ow">in</span> <span class="n">clicked_track</span><span class="p">:</span> <span class="c1"># 個別のKML/CSV点列をクリックした場合</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># 個別の他軌道をクリックした場合</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">clicked_track_rematt</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">clicked_track_rematt</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">clicked_zone</span> <span class="o">==</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">clicked_column</span> <span class="o">==</span> <span class="s1">&#39;#1&#39;</span><span class="p">:</span> <span class="c1">#ラインカラーをクリックしたら、カラーピッカーを開く</span>
                    <span class="k">if</span> <span class="s1">&#39;@&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clicked_track</span><span class="p">:</span>
                        <span class="n">nowcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">track_data</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="s1">&#39;@KML_&#39;</span> <span class="ow">in</span> <span class="n">clicked_track</span> <span class="ow">or</span> <span class="s1">&#39;@CSV_&#39;</span> <span class="ow">in</span> <span class="n">clicked_track</span><span class="p">:</span>
                        <span class="n">nowcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">nowcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">clicked_track_rematt</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
                    <span class="n">inputdata</span> <span class="o">=</span> <span class="n">colorchooser</span><span class="o">.</span><span class="n">askcolor</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">nowcolor</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">inputdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># カラーピッカーでキャンセルされなかった場合、当該軌道に色を指定</span>
                        <span class="k">if</span> <span class="s1">&#39;@&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">clicked_track</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">track_data</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="n">clicked_track</span><span class="p">,</span><span class="n">foreground</span><span class="o">=</span><span class="n">inputdata</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="s1">&#39;@KML_&#39;</span> <span class="ow">in</span> <span class="n">clicked_track</span> <span class="ow">or</span> <span class="s1">&#39;@CSV_&#39;</span> <span class="ow">in</span> <span class="n">clicked_track</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">clicked_track</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="n">clicked_track</span><span class="p">,</span><span class="n">foreground</span><span class="o">=</span><span class="n">inputdata</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">clicked_track_rematt</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inputdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="n">clicked_track</span><span class="p">,</span><span class="n">foreground</span><span class="o">=</span><span class="n">inputdata</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">drawall</span><span class="p">()</span></div>
<div class="viewcode-block" id="TrackWindow.set_treevalue"><a class="viewcode-back" href="../../tsutsuji.trackwindow.html#tsutsuji.trackwindow.TrackWindow.set_treevalue">[docs]</a>    <span class="k">def</span> <span class="nf">set_treevalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; 軌道データをツリーリストに表示する</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># cfgファイルから読み込んだ軌道の表示</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">colorix</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">track</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>\
                                   <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;■■■&#39;</span><span class="p">),</span>\
                                   <span class="n">tags</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">track_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">change_state</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;checked&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;unchecked&#39;</span><span class="p">)</span>

        <span class="c1"># KML/CSVから読み込んだ点列データの表示</span>
        <span class="n">label_sqtr</span> <span class="o">=</span> <span class="s1">&#39;seq_points&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">label_sqtr</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">label_sqtr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="n">label_sqtr</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">label_sqtr</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">label_sqtr</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>\
                                   <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;■■■&#39;</span><span class="p">),</span>\
                                   <span class="n">tags</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">change_state</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;checked&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">pointsequence_track</span><span class="o">.</span><span class="n">track</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;unchecked&#39;</span><span class="p">)</span>

        <span class="c1"># generateした他軌道の表示</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;generated&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;generated&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s1">&#39;generated&#39;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;generated&#39;</span><span class="p">,</span> <span class="nb">open</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="s2">&quot;generated&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s1">&#39;@OT_&#39;</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>\
                                       <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;■■■&#39;</span><span class="p">),</span>\
                                       <span class="n">tags</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;@OT_&#39;</span><span class="o">+</span><span class="n">i</span><span class="p">,))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="s1">&#39;@OT_&#39;</span><span class="o">+</span><span class="n">i</span><span class="p">,</span><span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">track_tree</span><span class="o">.</span><span class="n">change_state</span><span class="p">(</span><span class="s1">&#39;@OT_&#39;</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;checked&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">trackcontrol</span><span class="o">.</span><span class="n">generated_othertrack</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;toshow&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;unchecked&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="TrackWindow.reset_treevalue"><a class="viewcode-back" href="../../tsutsuji.trackwindow.html#tsutsuji.trackwindow.TrackWindow.reset_treevalue">[docs]</a>    <span class="k">def</span> <span class="nf">reset_treevalue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; ツリーリストを再構築する</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># track windowが表示されている場合にのみ再構築</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_treevalue</span><span class="p">()</span></div>
<div class="viewcode-block" id="TrackWindow.closewindow"><a class="viewcode-back" href="../../tsutsuji.trackwindow.html#tsutsuji.trackwindow.TrackWindow.closewindow">[docs]</a>    <span class="k">def</span> <span class="nf">closewindow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="TrackWindow.sendtopmost"><a class="viewcode-back" href="../../tsutsuji.trackwindow.html#tsutsuji.trackwindow.TrackWindow.sendtopmost">[docs]</a>    <span class="k">def</span> <span class="nf">sendtopmost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">focus_force</span><span class="p">()</span></div></div>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">tsutsuji-trackcomputer  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">tsutsuji.trackwindow</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, konawasabi.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>